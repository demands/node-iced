#!/usr/bin/env node

// Generated by CoffeeScript 1.6.3
var glacier, jobParameters, knownOpts, nopt, parsedOptions, shortHands, vaultName;

exports.command = {
  description: 'Requests an inventory for a vault'
};

if (require.main === module) {
  glacier = require('../lib/glacier');
  nopt = require('nopt');
  knownOpts = {};
  shortHands = {};
  parsedOptions = nopt(knownOpts, shortHands, process.argv);
  vaultName = parsedOptions.argv.remain.shift();
  if (vaultName == null) {
    console.error("usage: iced inventory <vault>\n\nRequests an inventory for <vault>, creating a new job");
  }
  jobParameters = {
    Type: 'inventory-retrieval'
  };
  glacier.initiateJob({
    vaultName: vaultName,
    jobParameters: jobParameters
  }, function(err, data) {
    if (err != null) {
      console.error(err.message);
      process.exit(1);
    }
    console.log("Initiated inventory job '" + data.jobId + "' at " + data.location);
    return process.exit(0);
  });
}
